!function(){"use strict";var t,i,e,n,r,a=a||{},s=Math.PI,o=Math.sin,h=30,c=5,p=[];t=2*h*o(s/3),e=15*h+2*c,i=20*t+2*c,r=d3.select("body").append("svg").attr("width",i).attr("height",e).style("padding",c+"px"),a.Ant=function(t,i){var e;_.isUndefined(i)||(e=t,t=n.matrix[e][i]),this.timer=null,this.point=t,this.trail=[],this.node=r.append("circle").attr("class","ant").attr("cx",t[0]).attr("cy",t[1]).attr("r",3),this.go=function(t,i){_.isUndefined(i)||(e=t,t=n.matrix[e][i]),this.trail.push(this.point.index),this.point=t,this.node.transition().attr("cx",t[0]).attr("cy",t[1])},this.start=function(){var t=this;this.stop(),this.timer=setInterval(function(){var i=[],e=t.trail;_.each(t.point.next,function(t){-1===_.indexOf(e,t.index)&&i.push(t)}),0===i.length&&(i=t.point.next),t.go(i[_.random(i.length-1)])},300)},this.stop=function(){this.timer&&clearInterval(this.timer)},this.destroy=function(){this.stop(),this.node&&this.node.remove()}},a.ACO=function(){this.count=100,this.alpha=.5,this.beta=1,this.rho=.5,this.q=0,this._started=!1,this.initColony=function(){for(var t=0;t<this.count;t++)p.push(new a.Ant(0,0))},this["start/stop"]=function(){p.length!==this.count&&this.initColony();for(var t=0;t<this.count;t++)this._started?p[t].stop():p[t].start();this._started?this._started=!1:this._started=!0},this.destroy=function(){for(var t=0;t<this.count;t++)p[t].destroy();p=[],this._started=!1}},Object.defineProperty(a.ACO.prototype,"type",{get:function(){return this._type||null},set:function(t){t&&(this.destroy(),n.type=this._type=t)}}),a.Map=function(){},Object.defineProperty(a.Map.prototype,"type",{get:function(){return this._type},set:function(t){this._type=t,this.init(),this.construct()}}),a.Map.prototype.init=function(){this.matrix=[],this.points=[],this.edges=[]},a.Map.prototype.construct=function(){switch(this.type){case"triangle":this.constructTriangle();break;case"square":this.constructSquare();break;case"hexagon":default:this.constructHexagon()}this.buildMap()},a.Map.prototype.constructSquare=function(){var t,n,r,a,s,o=this;for(n=0,s=c;e-c>s;s+=2*h,n++)for(r=0,a=c;i-c>=a;a+=2*h,r++)t=[a,s],t.i=n,t.j=r,t.index=[n,r],t.next=[],_.isUndefined(o.matrix[n])&&(o.matrix[n]=[]),o.matrix[n][r]=t,o.points.push(t);_.each(o.matrix,function(t,i){_.each(t,function(t,e){o.matrix[i+1]&&o.matrix[i+1][e]&&o.edges.push([t,o.matrix[i+1][e]]),o.matrix[i][e+1]&&o.edges.push([t,o.matrix[i][e+1]])})}),_.each(o.edges,function(t){o.matrix[t[0].i][t[0].j].next.push(o.matrix[t[1].i][t[1].j]),o.matrix[t[1].i][t[1].j].next.push(o.matrix[t[0].i][t[0].j])})},a.Map.prototype.constructHexagon=function(){var n,r,a,s,o,p=this;for(r=0,o=c;e-c>o;o+=r%2?h:h/2,r++)for(a=0,s=(r%4===0||r%4===3?t/2:0)+c;i-c>=s;s+=t,a++)n=[s,o],n.i=r,n.j=a,n.index=[r,a],n.next=[],_.isUndefined(p.matrix[r])&&(p.matrix[r]=[]),p.matrix[r][a]=n,p.points.push(n);_.each(p.matrix,function(t,i){_.each(t,function(t,e){p.matrix[i+1]&&p.matrix[i+1][e]&&p.edges.push([t,p.matrix[i+1][e]]),i%4!==2&&i%2===0&&p.matrix[i+1]&&p.matrix[i+1][e+1]&&p.edges.push([t,p.matrix[i+1][e+1]]),i%4===2&&p.matrix[i+1]&&p.matrix[i+1][e-1]&&p.edges.push([t,p.matrix[i+1][e-1]])})}),_.each(p.edges,function(t){p.matrix[t[0].i][t[0].j].next.push(p.matrix[t[1].i][t[1].j]),p.matrix[t[1].i][t[1].j].next.push(p.matrix[t[0].i][t[0].j])})},a.Map.prototype.constructTriangle=function(){var n,r,a,s,o,p=this;for(r=0,o=c;e-c>o;o+=h,r++)for(a=0,s=(r%2===0?t:0)+c;i-c>=s;s+=2*t,a++)n=[s,o],n.i=r,n.j=a,n.index=[r,a],n.next=[],_.isUndefined(p.matrix[r])&&(p.matrix[r]=[]),p.matrix[r][a]=n,p.points.push(n);_.each(p.matrix,function(t,i){_.each(t,function(t,e){p.matrix[i+1]&&p.matrix[i+1][e]&&p.edges.push([t,p.matrix[i+1][e]]),i%2===0&&p.matrix[i+1]&&p.matrix[i+1][e+1]&&p.edges.push([t,p.matrix[i+1][e+1]]),i%2!==0&&p.matrix[i+1]&&p.matrix[i+1][e-1]&&p.edges.push([t,p.matrix[i+1][e-1]]),p.matrix[i+2]&&p.matrix[i+2][e]&&p.edges.push([t,p.matrix[i+2][e]])})}),_.each(p.edges,function(t){p.matrix[t[0].i][t[0].j].next.push(p.matrix[t[1].i][t[1].j]),p.matrix[t[1].i][t[1].j].next.push(p.matrix[t[0].i][t[0].j])})},a.Map.prototype.buildMap=function(){r.selectAll(".node").remove(),r.selectAll(".link").remove();var t=this;r.selectAll(".node").data(t.points).enter().append("circle").attr("class","node").attr("cx",function(t){return t[0]}).attr("cy",function(t){return t[1]}).attr("r",2),r.selectAll(".link").data(t.edges).enter().append("line").attr("class","link").attr("x1",function(t){return t[0][0]}).attr("y1",function(t){return t[0][1]}).attr("x2",function(t){return t[1][0]}).attr("y2",function(t){return t[1][1]})},n=new a.Map,n.type="triangle",window.onload=function(){var t=new a.ACO,i=new dat.GUI;i.add(t,"type",["triangle","square","hexagon"]),i.add(t,"count",10,200).step(10),i.add(t,"alpha",0,1).step(.01),i.add(t,"beta",1,10).step(.1),i.add(t,"rho",0,1).step(.01),i.add(t,"start/stop"),i.add(t,"destroy"),i.remember(t)}}();